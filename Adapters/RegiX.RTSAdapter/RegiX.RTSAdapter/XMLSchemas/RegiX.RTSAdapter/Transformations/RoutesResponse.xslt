<?xml version="1.0" encoding="UTF-8"?>
<!--Designed and generated by Altova StyleVision Enterprise Edition 2008 rel. 2 sp1 - see http://www.altova.com/stylevision for more information.-->
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fn="http://www.w3.org/2005/xpath-functions" xmlns:rts="http://egov.bg/RegiX/MTITC/Rts" xmlns:xdt="http://www.w3.org/2005/xpath-datatypes" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:altova="http://www.altova.com">
	<xsl:output version="4.0" method="html" indent="no" encoding="UTF-8" doctype-public="-//W3C//DTD HTML 4.0 Transitional//EN" doctype-system="http://www.w3.org/TR/html4/loose.dtd"/>
	<xsl:param name="SV_OutputFormat" select="'HTML'"/>
	<xsl:variable name="XML" select="/"/>
	<xsl:template match="/">
		<html>
			<head>
				<title/>
			</head>
			<body>
				<xsl:for-each select="$XML">
					<xsl:for-each select="rts:RoutesResponse">
						<h3 align="center">
							<span>
								<xsl:text>Изпълнителна агенция &quot;Автомобилна администрация&quot;</xsl:text>
							</span>
							<br/>
							<span>
								<xsl:text>Републиканска транспортна схема</xsl:text>
							</span>
						</h3>
						<h2 align="center">
							<span>
								<xsl:text>Справка за маршрутни разписания, свързващи спирки на територията на две общини </xsl:text>
							</span>
							<br/>
							<span>
								<xsl:text>и отговарящи на допълнителни критерии за конфликт</xsl:text>
							</span>
							<xsl:for-each select="rts:GenerationTimeStamp">
								<span>
									<xsl:text>, към дата </xsl:text>
								</span>
								<span>
									<xsl:value-of select="format-number(number(substring(string(string(.)), 9, 2)), '00')"/>
									<xsl:text>.</xsl:text>
									<xsl:value-of select="format-number(number(substring(string(string(.)), 6, 2)), '00')"/>
									<xsl:text>.</xsl:text>
									<xsl:value-of select="format-number(number(substring(string(string(string(.))), 1, 4)), '0000')"/>
									<xsl:text> </xsl:text>
									<xsl:value-of select="format-number(number(substring(string(string(.)), 12, 2)), '00')"/>
									<xsl:text>:</xsl:text>
									<xsl:value-of select="format-number(number(substring(string(string(.)), 15, 2)), '00')"/>
									<xsl:text>:</xsl:text>
									<xsl:choose>
										<xsl:when test="contains(string(string(.)), 'Z')">
											<xsl:value-of select="format-number(number(substring-after(substring-after(substring-before(string(string(.)), 'Z'), ':'), ':')), '00')"/>
										</xsl:when>
										<xsl:when test="contains(string(string(.)), '+')">
											<xsl:value-of select="format-number(number(substring-after(substring-after(substring-before(string(string(.)), '+'), ':'), ':')), '00')"/>
										</xsl:when>
										<xsl:when test="contains(substring(string(string(.)), 18), '-')">
											<xsl:value-of select="format-number(number(substring-before(substring(string(string(.)), 18), '-')), '00')"/>
										</xsl:when>
										<xsl:otherwise>
											<xsl:value-of select="format-number(number(substring(string(string(.)), 18)), '00')"/>
										</xsl:otherwise>
									</xsl:choose>
								</span>
							</xsl:for-each>
						</h2>
						<xsl:choose>
							<xsl:when test="count(rts:Routes/rts:Route)&gt;0 and string(  rts:Routes ) != &apos;&apos;">
								<xsl:for-each select="rts:Routes">
									<xsl:for-each select="rts:Route">
										<div style="font-size:small; font-weight:bold; " align="left">
											<span style="font-size:small; ">
												<xsl:text>Маршрутно разписание: </xsl:text>
											</span>
											<span style="font-size:small; font-style:italic; font-weight:bold; ">
												<xsl:value-of select="position()"/>
											</span>
											<span style="font-size:small; font-style:italic; font-weight:bold; ">
												<xsl:text> от </xsl:text>
											</span>
											<span style="font-size:small; font-style:italic; font-weight:bold; ">
												<xsl:value-of select="count(   /rts:RoutesResponse/rts:Routes/rts:Route )"/>
											</span>
										</div>
										<div style="border-collapse:collapse; border-style:solid; border-width:thin; ">
											<table border="0" cellpadding="0" cellspacing="0" width="100%">
												<tbody>
													<tr>
														<td style="font-size:small; " valign="top" width="33%">
															<xsl:for-each select="rts:RouteName">
																<span style="font-size:small; font-style:italic; ">
																	<xsl:text>Наименование</xsl:text>
																</span>
																<span style="font-size:small; ">
																	<xsl:text>: </xsl:text>
																</span>
																<span style="font-size:small; font-weight:bold; ">
																	<xsl:apply-templates/>
																</span>
															</xsl:for-each>
														</td>
														<td style="font-size:small; " valign="top" width="33%">
															<xsl:for-each select="rts:ApprovalDate">
																<span style="font-size:small; font-style:italic; ">
																	<xsl:text>Дата на одобрение:</xsl:text>
																</span>
																<span style="font-size:small; ">
																	<xsl:text>&#160;</xsl:text>
																</span>
																<span style="font-size:small; ">
																	<xsl:value-of select="format-number(number(substring(string(string(.)), 9, 2)), '00')"/>
																	<xsl:text>.</xsl:text>
																	<xsl:value-of select="format-number(number(substring(string(string(.)), 6, 2)), '00')"/>
																	<xsl:text>.</xsl:text>
																	<xsl:value-of select="format-number(number(substring(string(string(string(.))), 1, 4)), '0000')"/>
																</span>
																<span style="font-size:small; ">
																	<xsl:text> г.</xsl:text>
																</span>
															</xsl:for-each>
														</td>
														<td style="font-size:small; " valign="top" width="33%">
															<xsl:for-each select="rts:DriversCount">
																<span style="font-size:small; font-style:italic; ">
																	<xsl:text>Изпълнява се от</xsl:text>
																</span>
																<span style="font-size:small; ">
																	<xsl:text>&#160;</xsl:text>
																</span>
																<span style="font-size:small; ">
																	<xsl:apply-templates/>
																</span>
																<span style="font-size:small; ">
																	<xsl:text>&#160;</xsl:text>
																</span>
																<xsl:choose>
																	<xsl:when test="(.) &gt;1">
																		<span style="font-size:small; ">
																			<xsl:text>водача</xsl:text>
																		</span>
																	</xsl:when>
																	<xsl:when test=". = 1">
																		<span style="font-size:small; ">
																			<xsl:text>водач</xsl:text>
																		</span>
																	</xsl:when>
																</xsl:choose>
															</xsl:for-each>
														</td>
													</tr>
													<tr>
														<td style="font-size:small; " valign="top" width="33%">
															<xsl:for-each select="rts:RouteCode">
																<span style="font-size:small; font-style:italic; ">
																	<xsl:text>Код: </xsl:text>
																</span>
																<span style="font-size:small; font-weight:bold; ">
																	<xsl:apply-templates/>
																</span>
															</xsl:for-each>
															<xsl:for-each select="rts:RouteDescrtiption">
																<xsl:if test="string-length(rts:RouteDescrtiption )&gt;0">
																	<br/>
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Описание:</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text>&#160;</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:apply-templates/>
																	</span>
																</xsl:if>
															</xsl:for-each>
														</td>
														<td style="font-size:small; " valign="top" width="33%">
															<xsl:for-each select="rts:ValidTo">
																<span style="font-size:small; font-style:italic; ">
																	<xsl:text>Дата на валидност: </xsl:text>
																</span>
																<span style="font-size:small; ">
																	<xsl:value-of select="format-number(number(substring(string(string(.)), 9, 2)), '00')"/>
																	<xsl:text>.</xsl:text>
																	<xsl:value-of select="format-number(number(substring(string(string(.)), 6, 2)), '00')"/>
																	<xsl:text>.</xsl:text>
																	<xsl:value-of select="format-number(number(substring(string(string(string(.))), 1, 4)), '0000')"/>
																</span>
																<span style="font-size:small; ">
																	<xsl:text> г.</xsl:text>
																</span>
															</xsl:for-each>
														</td>
														<td style="font-size:small; " valign="top" width="33%">
															<xsl:for-each select="rts:BusesCount">
																<span style="font-size:small; font-style:italic; ">
																	<xsl:text>Изпълнява се от</xsl:text>
																</span>
																<span style="font-size:small; ">
																	<xsl:text>&#160;</xsl:text>
																</span>
																<span style="font-size:small; ">
																	<xsl:apply-templates/>
																</span>
																<span style="font-size:small; ">
																	<xsl:text>&#160;</xsl:text>
																</span>
																<xsl:choose>
																	<xsl:when test="(.) &gt;1">
																		<span>
																			<xsl:text>автобуса</xsl:text>
																		</span>
																	</xsl:when>
																	<xsl:when test=". = 1">
																		<span>
																			<xsl:text>автобус</xsl:text>
																		</span>
																	</xsl:when>
																</xsl:choose>
															</xsl:for-each>
														</td>
													</tr>
													<tr>
														<td style="font-size:small; " valign="top" width="33%">
															<xsl:for-each select="rts:Contractor">
																<xsl:for-each select="rts:ContractorName">
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Община-възложител:</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text>&#160;</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:apply-templates/>
																	</span>
																</xsl:for-each>
															</xsl:for-each>
														</td>
														<td style="font-size:small; " valign="top" width="33%">
															<xsl:for-each select="rts:Seasonal">
																<span style="font-size:small; font-style:italic; ">
																	<xsl:text>Изпълнява се: </xsl:text>
																</span>
																<xsl:choose>
																	<xsl:when test="rts:IsSeasonal =&apos;true&apos;">
																		<span style="font-size:small; ">
																			<xsl:text>от </xsl:text>
																		</span>
																		<xsl:for-each select="rts:SeasonStartDay">
																			<span style="font-size:small; ">
																				<xsl:value-of select="format-number(number(substring(string(string(.)), 4, 2)), '00')"/>
																			</span>
																		</xsl:for-each>
																		<xsl:for-each select="rts:SeasonStartMonth">
																			<span style="font-size:small; ">
																				<xsl:text>&#160;</xsl:text>
																			</span>
																			<span style="font-size:small; ">
																				<xsl:call-template name="DateToMonthName">
																					<xsl:with-param name="sDate" select="string(string(.))"/>
																					<xsl:with-param name="sFormat" select="'long'"/>
																				</xsl:call-template>
																			</span>
																		</xsl:for-each>
																		<span style="font-size:small; ">
																			<xsl:text> до </xsl:text>
																		</span>
																		<xsl:for-each select="rts:SeasonEndDay">
																			<span style="font-size:small; ">
																				<xsl:value-of select="format-number(number(substring(string(string(.)), 4, 2)), '00')"/>
																			</span>
																		</xsl:for-each>
																		<xsl:for-each select="rts:SeasonEndMonth">
																			<span style="font-size:small; ">
																				<xsl:text>&#160;</xsl:text>
																			</span>
																			<span style="font-size:small; ">
																				<xsl:call-template name="DateToMonthName">
																					<xsl:with-param name="sDate" select="string(string(.))"/>
																					<xsl:with-param name="sFormat" select="'long'"/>
																				</xsl:call-template>
																			</span>
																		</xsl:for-each>
																	</xsl:when>
																	<xsl:when test="rts:IsSeasonal =&apos;false&apos;">
																		<span style="font-size:small; ">
																			<xsl:text>целогодишно</xsl:text>
																		</span>
																	</xsl:when>
																</xsl:choose>
															</xsl:for-each>
														</td>
														<td style="font-size:small; " valign="top" width="33%">
															<xsl:for-each select="rts:Schedule">
																<xsl:choose>
																	<xsl:when test="rts:IsDaily =&apos;true&apos;">
																		<span style="font-size:small; font-style:italic; ">
																			<xsl:text>Изпълнява се </xsl:text>
																		</span>
																		<span style="font-size:small; ">
																			<xsl:text>всеки ден</xsl:text>
																		</span>
																	</xsl:when>
																	<xsl:when test="rts:IsDaily =&apos;false&apos;">
																		<span style="font-size:small; font-style:italic; ">
																			<xsl:text>Изпълнява се в</xsl:text>
																		</span>
																		<span style="font-size:small; ">
																			<xsl:text>&#160;</xsl:text>
																		</span>
																		<xsl:for-each select="rts:Monday">
																			<div>
																				<xsl:choose>
																					<xsl:when test=". =&apos;true&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☑</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:when test=". =&apos;false&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:otherwise>
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:otherwise>
																				</xsl:choose>
																				<span style="font-size:small; ">
																					<xsl:text> понеделник</xsl:text>
																				</span>
																			</div>
																		</xsl:for-each>
																		<xsl:for-each select="rts:Tuesday">
																			<div>
																				<xsl:choose>
																					<xsl:when test=". =&apos;true&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☑</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:when test=". =&apos;false&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:otherwise>
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:otherwise>
																				</xsl:choose>
																				<span style="font-size:small; ">
																					<xsl:text> вторник</xsl:text>
																				</span>
																			</div>
																		</xsl:for-each>
																		<xsl:for-each select="rts:Wednesday">
																			<div>
																				<xsl:choose>
																					<xsl:when test=". =&apos;true&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☑</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:when test=". =&apos;false&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:otherwise>
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:otherwise>
																				</xsl:choose>
																				<span style="font-size:small; ">
																					<xsl:text> сряда</xsl:text>
																				</span>
																			</div>
																		</xsl:for-each>
																		<xsl:for-each select="rts:Thursday">
																			<div>
																				<xsl:choose>
																					<xsl:when test=". =&apos;true&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☑</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:when test=". =&apos;false&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:otherwise>
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:otherwise>
																				</xsl:choose>
																				<span style="font-size:small; ">
																					<xsl:text> четвъртък</xsl:text>
																				</span>
																			</div>
																		</xsl:for-each>
																		<xsl:for-each select="rts:Friday">
																			<div>
																				<xsl:choose>
																					<xsl:when test=". =&apos;true&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☑</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:when test=". =&apos;false&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:otherwise>
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:otherwise>
																				</xsl:choose>
																				<span style="font-size:small; ">
																					<xsl:text> петък</xsl:text>
																				</span>
																			</div>
																		</xsl:for-each>
																		<xsl:for-each select="rts:Saturday">
																			<div>
																				<xsl:choose>
																					<xsl:when test=". =&apos;true&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☑</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:when test=". =&apos;false&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:otherwise>
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:otherwise>
																				</xsl:choose>
																				<span style="font-size:small; ">
																					<xsl:text> събота</xsl:text>
																				</span>
																			</div>
																		</xsl:for-each>
																		<xsl:for-each select="rts:Sunday">
																			<div>
																				<xsl:choose>
																					<xsl:when test=". =&apos;true&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☑</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:when test=". =&apos;false&apos;">
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:when>
																					<xsl:otherwise>
																						<span style="font-size:small; font-weight:bold; ">
																							<xsl:text>☐</xsl:text>
																						</span>
																					</xsl:otherwise>
																				</xsl:choose>
																				<span style="font-size:small; ">
																					<xsl:text> неделя</xsl:text>
																				</span>
																			</div>
																		</xsl:for-each>
																	</xsl:when>
																</xsl:choose>
																<xsl:for-each select="rts:BeforeHoliday">
																	<br/>
																	<div>
																		<xsl:choose>
																			<xsl:when test=". =&apos;true&apos;">
																				<span style="font-size:small; font-weight:bold; ">
																					<xsl:text>☑</xsl:text>
																				</span>
																			</xsl:when>
																			<xsl:when test=". =&apos;false&apos;">
																				<span style="font-size:small; font-weight:bold; ">
																					<xsl:text>☐</xsl:text>
																				</span>
																			</xsl:when>
																			<xsl:otherwise>
																				<span style="font-size:small; font-weight:bold; ">
																					<xsl:text>☐</xsl:text>
																				</span>
																			</xsl:otherwise>
																		</xsl:choose>
																		<span style="font-size:small; ">
																			<xsl:text> предпразник</xsl:text>
																		</span>
																	</div>
																</xsl:for-each>
																<xsl:for-each select="rts:Holiday">
																	<div>
																		<xsl:choose>
																			<xsl:when test=". =&apos;true&apos;">
																				<span style="font-size:small; font-weight:bold; ">
																					<xsl:text>☑</xsl:text>
																				</span>
																			</xsl:when>
																			<xsl:when test=". =&apos;false&apos;">
																				<span style="font-size:small; font-weight:bold; ">
																					<xsl:text>☐</xsl:text>
																				</span>
																			</xsl:when>
																			<xsl:otherwise>
																				<span style="font-size:small; font-weight:bold; ">
																					<xsl:text>☐</xsl:text>
																				</span>
																			</xsl:otherwise>
																		</xsl:choose>
																		<span style="font-size:small; ">
																			<xsl:text> празник</xsl:text>
																		</span>
																	</div>
																</xsl:for-each>
															</xsl:for-each>
														</td>
													</tr>
												</tbody>
											</table>
										</div>
										<div style="border-style:solid; border-width:thin; ">
											<xsl:for-each select="rts:ForwardRoute">
												<div align="center">
													<span style="font-size:small; font-weight:bold; ">
														<xsl:text>Курс &quot;Отиване&quot;</xsl:text>
													</span>
												</div>
												<xsl:for-each select="rts:Paths">
													<table style="border-collapse:collapse; " border="1" cellpadding="0" cellspacing="0" width="100%">
														<thead style="text-align:center; ">
															<tr style="text-align:center; " align="center">
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>№</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>От спирка</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>До спирка</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>Заминаване</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>Пристигане</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>Престой</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>Разстояние (км.)</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>Скорост (км./ч.)</xsl:text>
																	</span>
																</th>
															</tr>
														</thead>
														<tbody>
															<xsl:for-each select="rts:Path">
																<tr valign="top">
																	<td>
																		<xsl:for-each select="rts:Order">
																			<span style="font-size:small; ">
																				<xsl:value-of select=". +1"/>
																			</span>
																		</xsl:for-each>
																	</td>
																	<td style="border-color:black; ">
																		<xsl:for-each select="rts:FromStation">
																			<xsl:for-each select="rts:Station">
																				<span style="font-size:small; ">
																					<xsl:text>&#160;</xsl:text>
																				</span>
																				<span style="font-size:small; ">
																					<xsl:apply-templates/>
																				</span>
																			</xsl:for-each>
																			<xsl:for-each select="rts:MunicipalityName">
																				<span style="font-size:small; ">
																					<xsl:text> (</xsl:text>
																				</span>
																				<span style="font-size:small; font-style:italic; ">
																					<xsl:apply-templates/>
																				</span>
																				<span style="font-size:small; ">
																					<xsl:text>)</xsl:text>
																				</span>
																			</xsl:for-each>
																		</xsl:for-each>
																	</td>
																	<td style="border-collapse:collapse; border-color:black; ">
																		<xsl:for-each select="rts:ToStation">
																			<xsl:for-each select="rts:Station">
																				<span style="font-size:small; ">
																					<xsl:text>&#160;</xsl:text>
																				</span>
																				<span style="font-size:small; ">
																					<xsl:apply-templates/>
																				</span>
																			</xsl:for-each>
																			<xsl:for-each select="rts:MunicipalityName">
																				<span style="font-size:small; ">
																					<xsl:text> (</xsl:text>
																				</span>
																				<span style="font-size:small; font-style:italic; ">
																					<xsl:apply-templates/>
																				</span>
																				<span style="font-size:small; ">
																					<xsl:text>)</xsl:text>
																				</span>
																			</xsl:for-each>
																		</xsl:for-each>
																	</td>
																	<td align="center">
																		<xsl:for-each select="rts:DepartTime">
																			<span style="font-size:small; ">
																				<xsl:value-of select="format-number(number(substring(string(string(.)), 1, 2)), '00')"/>
																				<xsl:text>:</xsl:text>
																				<xsl:value-of select="format-number(number(substring(string(string(.)), 4, 2)), '00')"/>
																			</span>
																		</xsl:for-each>
																	</td>
																	<td align="center">
																		<xsl:for-each select="rts:ArriveTime">
																			<span style="font-size:small; ">
																				<xsl:value-of select="format-number(number(substring(string(string(.)), 1, 2)), '00')"/>
																				<xsl:text>:</xsl:text>
																				<xsl:value-of select="format-number(number(substring(string(string(.)), 4, 2)), '00')"/>
																			</span>
																		</xsl:for-each>
																	</td>
																	<td align="center">
																		<xsl:for-each select="rts:Rest">
																			<span style="font-size:small; ">
																				<xsl:variable name="sDurationMin">
																					<xsl:call-template name="DurationToMin">
																						<xsl:with-param name="sDuration" select="string(.)"/>
																					</xsl:call-template>
																				</xsl:variable>
																				<xsl:value-of select="format-number(number($sDurationMin), '0')"/>
																				<xsl:text> мин.</xsl:text>
																			</span>
																		</xsl:for-each>
																	</td>
																	<td align="center">
																		<xsl:for-each select="rts:Distance">
																			<span style="font-size:small; ">
																				<xsl:apply-templates/>
																			</span>
																		</xsl:for-each>
																	</td>
																	<td align="center">
																		<xsl:for-each select="rts:Speed">
																			<span style="font-size:small; ">
																				<xsl:apply-templates/>
																			</span>
																		</xsl:for-each>
																	</td>
																</tr>
															</xsl:for-each>
														</tbody>
													</table>
												</xsl:for-each>
												<table border="0" cellpadding="0" cellspacing="0" width="100%">
													<tbody>
														<tr valign="top">
															<td width="33%">
																<xsl:for-each select="rts:Distance">
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Обща дължина: </xsl:text>
																	</span>
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:apply-templates/>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text>&#160;</xsl:text>
																	</span>
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>км.</xsl:text>
																	</span>
																</xsl:for-each>
															</td>
															<td width="33%">
																<xsl:for-each select="rts:TravelTime">
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Общо време за движение:</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text>&#160;</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:variable name="sDurationHour">
																			<xsl:call-template name="DurationToHour">
																				<xsl:with-param name="sDuration" select="string(.)"/>
																			</xsl:call-template>
																		</xsl:variable>
																		<xsl:value-of select="format-number(number($sDurationHour), '0')"/>
																		<xsl:text> часа, </xsl:text>
																		<xsl:variable name="sDurationMin">
																			<xsl:call-template name="DurationToMin">
																				<xsl:with-param name="sDuration" select="string(.)"/>
																			</xsl:call-template>
																		</xsl:variable>
																		<xsl:value-of select="format-number(number($sDurationMin), '0')"/>
																		<xsl:text> минути</xsl:text>
																	</span>
																</xsl:for-each>
																<xsl:for-each select="rts:TripTime">
																	<br/>
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Общо време за пътуване:</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text>&#160;</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:variable name="sDurationHour">
																			<xsl:call-template name="DurationToHour">
																				<xsl:with-param name="sDuration" select="string(.)"/>
																			</xsl:call-template>
																		</xsl:variable>
																		<xsl:value-of select="format-number(number($sDurationHour), '0')"/>
																		<xsl:text> часа, </xsl:text>
																		<xsl:variable name="sDurationMin">
																			<xsl:call-template name="DurationToMin">
																				<xsl:with-param name="sDuration" select="string(.)"/>
																			</xsl:call-template>
																		</xsl:variable>
																		<xsl:value-of select="format-number(number($sDurationMin), '0')"/>
																		<xsl:text> минути</xsl:text>
																	</span>
																</xsl:for-each>
															</td>
															<td width="33%">
																<xsl:for-each select="rts:TravelSpeed">
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Средна техническа скорост: </xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:apply-templates/>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text> км/ч</xsl:text>
																	</span>
																</xsl:for-each>
																<xsl:for-each select="rts:TripSpeed">
																	<br/>
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Средна съобщителна скорост: </xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:apply-templates/>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text> км/ч</xsl:text>
																	</span>
																</xsl:for-each>
															</td>
														</tr>
													</tbody>
												</table>
											</xsl:for-each>
										</div>
										<div style="border-style:solid; border-width:thin; ">
											<xsl:for-each select="rts:BackwardRoute">
												<div align="center">
													<span style="font-size:small; font-weight:bold; ">
														<xsl:text>Курс &quot;Връщане&quot;</xsl:text>
													</span>
												</div>
												<xsl:for-each select="rts:Paths">
													<table style="border-collapse:collapse; " border="1" cellpadding="0" cellspacing="0" width="100%">
														<thead style="text-align:center; ">
															<tr>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>№</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>От спирка</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>До спирка</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>Заминаване</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>Пристигане</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>Престой</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>Разстояние (км.)</xsl:text>
																	</span>
																</th>
																<th style="font-weight:normal; text-align:center; " align="center">
																	<span style="font-size:small; ">
																		<xsl:text>Скорост (км./ч.)</xsl:text>
																	</span>
																</th>
															</tr>
														</thead>
														<tbody>
															<xsl:for-each select="rts:Path">
																<tr valign="top">
																	<td>
																		<xsl:for-each select="rts:Order">
																			<span style="font-size:small; ">
																				<xsl:value-of select=". +1"/>
																			</span>
																		</xsl:for-each>
																	</td>
																	<td style="border-color:black; ">
																		<xsl:for-each select="rts:FromStation">
																			<xsl:for-each select="rts:Station">
																				<span style="font-size:small; ">
																					<xsl:text>&#160;</xsl:text>
																				</span>
																				<span style="font-size:small; ">
																					<xsl:apply-templates/>
																				</span>
																			</xsl:for-each>
																			<xsl:for-each select="rts:MunicipalityName">
																				<span>
																					<xsl:text>&#160;</xsl:text>
																				</span>
																				<span style="font-size:small; ">
																					<xsl:text>(</xsl:text>
																				</span>
																				<span style="font-size:small; font-style:italic; ">
																					<xsl:apply-templates/>
																				</span>
																				<span style="font-size:small; ">
																					<xsl:text>)</xsl:text>
																				</span>
																			</xsl:for-each>
																		</xsl:for-each>
																	</td>
																	<td style="border-collapse:collapse; border-color:black; ">
																		<xsl:for-each select="rts:ToStation">
																			<xsl:for-each select="rts:Station">
																				<span style="font-size:small; ">
																					<xsl:text>&#160;</xsl:text>
																				</span>
																				<span style="font-size:small; ">
																					<xsl:apply-templates/>
																				</span>
																			</xsl:for-each>
																			<xsl:for-each select="rts:MunicipalityName">
																				<span>
																					<xsl:text>&#160;</xsl:text>
																				</span>
																				<span style="font-size:small; ">
																					<xsl:text>(</xsl:text>
																				</span>
																				<span style="font-size:small; font-style:italic; ">
																					<xsl:apply-templates/>
																				</span>
																				<span style="font-size:small; ">
																					<xsl:text>)</xsl:text>
																				</span>
																			</xsl:for-each>
																		</xsl:for-each>
																	</td>
																	<td align="center">
																		<xsl:for-each select="rts:DepartTime">
																			<span style="font-size:small; ">
																				<xsl:value-of select="format-number(number(substring(string(string(.)), 1, 2)), '00')"/>
																				<xsl:text>:</xsl:text>
																				<xsl:value-of select="format-number(number(substring(string(string(.)), 4, 2)), '00')"/>
																			</span>
																		</xsl:for-each>
																	</td>
																	<td align="center">
																		<xsl:for-each select="rts:ArriveTime">
																			<span style="font-size:small; ">
																				<xsl:value-of select="format-number(number(substring(string(string(.)), 1, 2)), '00')"/>
																				<xsl:text>:</xsl:text>
																				<xsl:value-of select="format-number(number(substring(string(string(.)), 4, 2)), '00')"/>
																			</span>
																		</xsl:for-each>
																	</td>
																	<td align="center">
																		<xsl:for-each select="rts:Rest">
																			<span style="font-size:small; ">
																				<xsl:variable name="sDurationMin">
																					<xsl:call-template name="DurationToMin">
																						<xsl:with-param name="sDuration" select="string(.)"/>
																					</xsl:call-template>
																				</xsl:variable>
																				<xsl:value-of select="format-number(number($sDurationMin), '0')"/>
																				<xsl:text> мин.</xsl:text>
																			</span>
																		</xsl:for-each>
																	</td>
																	<td align="center">
																		<xsl:for-each select="rts:Distance">
																			<span style="font-size:small; ">
																				<xsl:apply-templates/>
																			</span>
																		</xsl:for-each>
																	</td>
																	<td align="center">
																		<xsl:for-each select="rts:Speed">
																			<span style="font-size:small; ">
																				<xsl:apply-templates/>
																			</span>
																		</xsl:for-each>
																	</td>
																</tr>
															</xsl:for-each>
														</tbody>
													</table>
												</xsl:for-each>
												<table border="0" cellpadding="0" cellspacing="0" width="100%">
													<tbody>
														<tr valign="top">
															<td width="33%">
																<xsl:for-each select="rts:Distance">
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Обща дължина: </xsl:text>
																	</span>
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:apply-templates/>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text> км.</xsl:text>
																	</span>
																</xsl:for-each>
															</td>
															<td width="33%">
																<xsl:for-each select="rts:TravelTime">
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Общо време за движение:</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text>&#160;</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:variable name="sDurationHour">
																			<xsl:call-template name="DurationToHour">
																				<xsl:with-param name="sDuration" select="string(.)"/>
																			</xsl:call-template>
																		</xsl:variable>
																		<xsl:value-of select="format-number(number($sDurationHour), '0')"/>
																		<xsl:text> часа, </xsl:text>
																		<xsl:variable name="sDurationMin">
																			<xsl:call-template name="DurationToMin">
																				<xsl:with-param name="sDuration" select="string(.)"/>
																			</xsl:call-template>
																		</xsl:variable>
																		<xsl:value-of select="format-number(number($sDurationMin), '0')"/>
																		<xsl:text> минути</xsl:text>
																	</span>
																</xsl:for-each>
																<xsl:for-each select="rts:TripTime">
																	<br/>
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Общо време за пътуване:</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text>&#160;</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:variable name="sDurationHour">
																			<xsl:call-template name="DurationToHour">
																				<xsl:with-param name="sDuration" select="string(.)"/>
																			</xsl:call-template>
																		</xsl:variable>
																		<xsl:value-of select="format-number(number($sDurationHour), '0')"/>
																		<xsl:text> часа, </xsl:text>
																		<xsl:variable name="sDurationMin">
																			<xsl:call-template name="DurationToMin">
																				<xsl:with-param name="sDuration" select="string(.)"/>
																			</xsl:call-template>
																		</xsl:variable>
																		<xsl:value-of select="format-number(number($sDurationMin), '0')"/>
																		<xsl:text> минути</xsl:text>
																	</span>
																</xsl:for-each>
															</td>
															<td width="33%">
																<xsl:for-each select="rts:TravelSpeed">
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Средна техническа скорост:</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text>&#160;</xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:apply-templates/>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text> км/ч</xsl:text>
																	</span>
																</xsl:for-each>
																<xsl:for-each select="rts:TripSpeed">
																	<br/>
																	<span style="font-size:small; font-style:italic; ">
																		<xsl:text>Средна съобщителна скорост: </xsl:text>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:apply-templates/>
																	</span>
																	<span style="font-size:small; ">
																		<xsl:text> км/ч</xsl:text>
																	</span>
																</xsl:for-each>
															</td>
														</tr>
													</tbody>
												</table>
											</xsl:for-each>
										</div>
										<br/>
									</xsl:for-each>
								</xsl:for-each>
							</xsl:when>
							<xsl:otherwise>
								<span>
									<xsl:text>Не са намерени маршрутни разписания по зададените критерии.</xsl:text>
								</span>
							</xsl:otherwise>
						</xsl:choose>
					</xsl:for-each>
				</xsl:for-each>
			</body>
		</html>
	</xsl:template>
	<xsl:template name="DateToMonthName">
		<xsl:param name="sDate"/>
		<xsl:param name="sFormat"/>
		<xsl:variable name="sMonthLong">
			<xsl:call-template name="DateToMonthNameLong">
				<xsl:with-param name="sDate" select="$sDate"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:choose>
			<xsl:when test="$sFormat = 'long'">
				<xsl:value-of select="$sMonthLong"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="substring($sMonthLong, 1, 3)"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="DateToMonthNameLong">
		<xsl:param name="sDate"/>
		<xsl:variable name="nMonth">
			<xsl:call-template name="DateToMonthNum">
				<xsl:with-param name="sDate" select="$sDate"/>
			</xsl:call-template>
		</xsl:variable>
		<xsl:choose>
			<xsl:when test="$nMonth = 1">January</xsl:when>
			<xsl:when test="$nMonth = 2">February</xsl:when>
			<xsl:when test="$nMonth = 3">March</xsl:when>
			<xsl:when test="$nMonth = 4">April</xsl:when>
			<xsl:when test="$nMonth = 5">May</xsl:when>
			<xsl:when test="$nMonth = 6">June</xsl:when>
			<xsl:when test="$nMonth = 7">July</xsl:when>
			<xsl:when test="$nMonth = 8">August</xsl:when>
			<xsl:when test="$nMonth = 9">September</xsl:when>
			<xsl:when test="$nMonth = 10">October</xsl:when>
			<xsl:when test="$nMonth = 11">November</xsl:when>
			<xsl:otherwise>December</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="DateToMonthNum">
		<xsl:param name="sDate"/>
		<xsl:value-of select="number(substring($sDate, 6, 2))"/>
	</xsl:template>
	<xsl:template name="DurationToMin">
		<xsl:param name="sDuration"/>
		<xsl:variable name="sTime" select="substring-after(string($sDuration), 'T')"/>
		<xsl:variable name="sMin">
			<xsl:choose>
				<xsl:when test="contains($sTime, 'H')">
					<xsl:value-of select="substring-before(substring-after($sTime, 'H'), 'M')"/>
				</xsl:when>
				<xsl:otherwise>
					<xsl:value-of select="substring-before($sTime, 'M')"/>
				</xsl:otherwise>
			</xsl:choose>
		</xsl:variable>
		<xsl:choose>
			<xsl:when test="string-length($sMin)=0">
				<xsl:value-of select="'0'"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="concat(substring-before(string($sDuration), 'P'), $sMin)"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
	<xsl:template name="DurationToHour">
		<xsl:param name="sDuration"/>
		<xsl:variable name="sTime" select="substring-after(string($sDuration), 'T')"/>
		<xsl:variable name="sHour" select="substring-before($sTime, 'H')"/>
		<xsl:choose>
			<xsl:when test="string-length($sHour)=0">
				<xsl:value-of select="'0'"/>
			</xsl:when>
			<xsl:otherwise>
				<xsl:value-of select="concat(substring-before(string($sDuration), 'P'), $sHour)"/>
			</xsl:otherwise>
		</xsl:choose>
	</xsl:template>
</xsl:stylesheet>
